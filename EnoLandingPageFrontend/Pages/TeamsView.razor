@page "/teams"
@using EnoLandingPageFrontend.Services
@using EnoLandingPageCore.Messages
@inject LandingPageDataApiService DataService

<div class="container p-3">
    <h1>Teams</h1>

    @if (teams != null)
    {
<div>
    <hr />
    <h4>Confirmed</h4>
    @foreach (var team in teams.ConfirmedTeams)
    {
        @if (team.CtftimeId is long ctftimeId)
        {
            string? countryUrl = team.CountryCode != null ? $"https://cdn.ipregistry.co/flags/wikimedia/{team.CountryCode?.ToLower()}.png" : null;
            <div class="teams-list-container">
                <img src="@team.LogoUrl" class="team-list-item-logo" referrerpolicy="no-referrer" />
                <a style="margin-left:0.5em" href="https://ctftime.org/team/@(ctftimeId)">@team.Name</a>
                <img src="@countryUrl" class="team-list-item-countryflag" referrerpolicy="no-referrer" />
            </div>
        }
        else
        {
            <div>@team.Name</div>
        }
    }

    <hr />
    <h4>Registered</h4>
    @foreach (var team in teams.RegisteredTeams)
    {
        @if (team.CtftimeId is long ctftimeId)
        {
            string countryUrl = $"https://cdn.ipregistry.co/flags/wikimedia/{team.CountryCode?.ToLower()}.png";
            <div class="teams-list-container">
                <img src="@team.LogoUrl" class="team-list-item-logo" referrerpolicy="no-referrer" />
                <a style="margin-left:0.5em" href="https://ctftime.org/team/@(ctftimeId)">@team.Name</a>
                <img src="@countryUrl" class="team-list-item-countryflag" referrerpolicy="no-referrer" />
            </div>
        }
        else
        {
            <div>@team.Name</div>
        }
    }
</div>
    }
</div>

@code {
    private TeamsMessage? teams;

    protected override async Task OnInitializedAsync()
    {
        teams = await DataService.GetTeams();
    }
}